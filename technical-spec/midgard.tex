\documentclass[11pt,a4paper,oneside]{book}
\usepackage{midgard}
\usepackage{midgard-diagram}
\usepackage{midgard-notation}

\usepackage{subfiles} % Best loaded last in the preamble
\begin{document}

\frontmatter
\subfileinclude{0-frontmatter/1-cover-page}
\subfileinclude{0-frontmatter/2-abstract}
\mainmatter
\subfileinclude{0-frontmatter/3-toc}
\subfileinclude{0-frontmatter/4-introduction}

\subfile{1-ledger-state/0-chapter}
\subfile{1-ledger-state/1-block}
\subfile{1-ledger-state/2-utxo-set}
\subfile{1-ledger-state/3-deposit-event}
\subfile{1-ledger-state/4-withdrawal-event}
\subfile{1-ledger-state/5-transaction-order-event}
\subfile{1-ledger-state/6-transaction}
\subfile{1-ledger-state/7-confirmed-state}

\subfile{2-user-event-protocol/0-chapter}
\subfile{2-user-event-protocol/1-deposit}
\subfileinclude{2-user-event-protocol/2-transaction-request}
\subfileinclude{2-user-event-protocol/3-transaction-order}
\subfileinclude{2-user-event-protocol/4-withdrawal-order}
\subfileinclude{2-user-event-protocol/5-witness-staking-script}


\subfile{3-consensus-protocol/0-chapter}
\subfileinclude{3-consensus-protocol/1-time-model}
\subfileinclude{3-consensus-protocol/2-operator-directory}
\subfileinclude{3-consensus-protocol/3-scheduler}
\subfileinclude{3-consensus-protocol/4-state-queue}
\subfileinclude{3-consensus-protocol/5-escape-hatch}
\subfileinclude{3-consensus-protocol/6-settlement-queue}
\subfileinclude{3-consensus-protocol/7-reserve}
\subfileinclude{3-consensus-protocol/8-hub-oracle}

\subfile{4-proof-protocol/0-chapter}
\subfile{4-proof-protocol/1-fraud-proof-catalogue}
\subfileinclude{4-proof-protocol/2-fraud-proof-tokens}
\subfileinclude{4-proof-protocol/3-computation-thread}

\subfile{5-ledger-rules/0-chapter}
\subfile{5-ledger-rules/1-cardano-ledger-rules}
\subfileinclude{5-ledger-rules/2-custom-midgard-ledger-rules}
\subfileinclude{5-ledger-rules/3-da-rules}

\subfile{6-offchain-data-architecture/0-chapter}
\subfile{6-offchain-data-architecture/1-da-layer}
\subfile{6-offchain-data-architecture/2-archive-node}

\subfile{7-phase-two-validation/0-chapter}
\subfile{7-phase-two-validation/1-state-representation}
\subfile{7-phase-two-validation/2-decoding-off-chain}
\subfile{7-phase-two-validation/3-fraud-proofs-involved}

\appendix
\subfile{A-general-data-structures/0-chapter}
\subfile{A-general-data-structures/1-linked-list}
\subfileinclude{A-general-data-structures/2-single-threaded-state-machine}

\subfile{B-l1-transactions/0-chapter}

\subfile{C-considerations/0-chapter}
\subfile{C-considerations/1-protocol-invariants}
\subfileinclude{C-considerations/2-protocol-parameters}
\subfileinclude{C-considerations/3-protocol-security}

\phantomsection
\addcontentsline{toc}{chapter}{List of figures}
\listoffigures

\end{document}
