# Midgard Technical specification

## Contributor guidelines

This LaTeX project adopts the following conventions in all `.tex` files:

1. All sentences should be separated by a newline character so that it's easier to review changes in PRs:
```
% Like this:
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

% _Not_ like this:
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
```

## Building this LaTeX project

### Command line

Please ensure that [nix is installed](https://nixos.org/download/#download-nix) in your system and [flakes are enabled](https://nixos.wiki/wiki/Flakes).

Build in one step:

1. From the repository root directory, run the following:
    ```bash
    pushd technical-spec; make nix-build; popd
    ```

Alternative build workflow, step-by-step:

1. From the repository root directory, go into the technical-spec subdirectory:
    ```bash
    cd technical-spec
    ```
2. Open a nix shell with the necessary latex packages installed:
    ```bash
    make shell
    ```
3. Build the latex PDF:
    ```bash
    make build
    ```

Clean all the files generated by `make build`:

1. From the repository root directory, go into the technical-spec subdirectory:
    ```bash
    cd technical-spec
    ```

2. Clean the files:
    ```bash
    make clean
    ```

The [direnv](https://direnv.net/) shell extension can automate the process of opening a nix shell inside any repository that contains a nix flake. This project is configured to use it.

### VS Code

In addition to the nix dependencies above, this requires two VS Code extensions:

- `direnv-vscode` ([github link](https://github.com/direnv/direnv-vscode))
- `LaTeX-Workshop` ([github link](https://github.com/James-Yu/LaTeX-Workshop))

Build steps:

1. Open VS Code in the technical-specs directory:
    ```bash
    code technical-spec
    ```
2. Select the main TeX file (`midgard.tex`)
3. Click the green play button (top right of file pane) to build the LaTeX project (CTRL + ALT + B).

### Neovim (advanced)

In addition to the nix dependencies above, this requires the [VimTex](https://github.com/lervag/vimtex). Install and configure the plugin according to the instructions in the link.

Build steps:

1. Open a nix shell in `technical-spec`.
2. Open the main TeX file with Neovim `nvim midgard.tex`.
3. Turn on the continuous build using VimTex's hotkey, by default `<LocalLeader>ll`. Now, it will also rebuild whenever you save changes to a `.tex` file in the directory.

The [Sioyek PDF viewer](https://sioyek.info/) works particularly well with VimTex on Linux (tested on Wayland).

### Emacs

Most Emacs distributions comes with built-in support to build the LaTeX project.

Build steps:

1. Open the midgard.tex file with emacs:
    ```bash
    emacs technical-spec/midgard.pdf
    ```
2. Invoke the `tex-compile` command (usually `M-x tex-compile`)
